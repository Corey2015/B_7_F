type fingerprintd, domain;
type fingerprintd_exec, exec_type, file_type;

# fingerprintd
init_daemon_domain(fingerprintd)
binder_use(fingerprintd)

# need to find KeyStore and add self
allow fingerprintd fingerprintd_service:service_manager { add find };

# allow HAL module to read dir contents
allow fingerprintd fingerprintd_data_file:file { create_file_perms };

# allow HAL module to read/write/unlink contents of this dir
allow fingerprintd fingerprintd_data_file:dir rw_dir_perms;

# Need to add auth tokens to KeyStore
use_keystore(fingerprintd)
allow fingerprintd keystore:keystore_key { add_auth };

# For permissions checking
binder_call(fingerprintd, system_server);
allow fingerprintd permission_service:service_manager find;
allow fingerprintd madev_fp_device:chr_file { read write ioctl open };
#add by corey
allow fingerprintd fpsensor_device:chr_file { read open write ioctl };

# formuex

type fingerprint_device, dev_type;

# write /sys/bus/spi/devices/spi12.0/spi_prepare
#allow fingerprintd sysfs_fingerprintd:file rw_file_perms;
allow fingerprintd sysfs:file rw_file_perms;

#/dev/fsc_spi fingerprint_device
allow fingerprintd fingerprint_device:chr_file rw_file_perms;

#/data/fsc fingerprintd_data_file
allow fingerprintd fingerprintd_data_file:sock_file create_file_perms;

#/data/fsc fingerprintd_data_file
#allow system_app   fingerprintd_data_file:sock_file {read write search};
allow system_app   fingerprintd_data_file:sock_file rw_file_perms;
#allow system_app system_data_file:sock_file rw_file_perms;
allow system_app   fingerprintd_data_file:dir { search } ;
allow system_app   fingerprintd:unix_stream_socket { connectto read write };


allow system_app   fingerprint_service:service_manager { add };
